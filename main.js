(()=>{"use strict";class t{static assertValidString(t){if("string"!=typeof t&&!(t instanceof String)||""===t)throw Error("Invalid string")}}class e{static generateId(){return Date.now().toString()+"-"+crypto.randomUUID()}}class i{#t=null;#e=null;#i=null;#o=null;#r=null;#s=null;#a=null;constructor(t,i,o,r,s,a){this.#t=e.generateId(),this.title=t,this.description=i,this.dueDate=o,this.priority=r,this.isChecked=s,this.#a=a}get id(){return this.#t}get title(){return this.#e}get description(){return this.#i}get dueDate(){return this.#o}get priority(){return this.#r}get isChecked(){return this.#s}get projectId(){return this.#a}set id(t){this.#t=t}set title(e){t.assertValidString(e),this.#e=e}set description(t){this.#i=t}set dueDate(t){this.#o=t}set priority(t){this.#r=t}set isChecked(t){this.#s=t.toString()}edit(t,e,i,o,r){this.title=t,this.description=e,this.dueDate=i,this.priority=o,this.isChecked=r}}class o{#t=null;#c=null;#n=[];constructor(t){this.#t=e.generateId(),this.name=t}get id(){return this.#t}get name(){return this.#c}get toDos(){return this.#n}set id(t){this.#t=t}set name(e){t.assertValidString(e),this.#c=e}edit(t){this.name=t}addToDo(t,e,o,r,s){const a=new i(t,e,o,r,s,this.id);return this.#n.push(a),a}pushToDo(t){this.#n.push(t)}getToDo(t){let e=null;for(let i of this.#n)if(i.id===t){e=i;break}return e}removeToDo(t){for(let e=this.#n.length-1;e>=0;e--)if(this.#n[e].id===t){this.#n.splice(e,1);break}}}class r{static#l=[];static addProject(t){const e=new o(t);return this.#l.push(e),e}static getProject(t){let e=null;for(let i of this.#l)if(i.id===t){e=i;break}return e}static removeProject(t){for(let e=this.#l.length-1;e>=0;e--)if(this.#l[e].id===t){this.#l.splice(e,1);break}}static getProjects(){return this.#l}static setProjects(t){this.#l=t}static getRelatedToDos(t){return this.getProject(t).toDos}}class s{static HIGH="high";static MEDIUM="medium";static LOW="low"}class a{static#d;static#u;static#h;static#p;static#m;static#S;static#y;static#b;static#j;static#v;static#g;static initialize(t){this.#d=t,this.#u=document.querySelector(".sidebar-content"),this.#h=document.querySelector(".project-form"),this.#m=document.querySelector("#add-project-button"),this.#S=document.querySelector("#project-form-name"),this.#p=this.#P('<div class="project-item" data-id=""> <div class="project-name"></div> <button class="project-remove visual-button remove-button small-button square"></button> </div>'),this.#y=document.querySelector(".main-panel"),this.#b=this.#P('<div class="main-panel-header"> <div class="main-panel-title"> <div class="main-panel-project-name"></div> <button id="add-todo-button" class="visual-button add-button"></button> </div> </div>'),this.#j=this.#P('<div class="to-do-item" data-id=""> <input type="checkbox" class="preview-checkbox" name="isChecked" value="isChecked"> <div class="preview-title"></div> <div class="preview-due-date"></div> <button class="to-do-inspect visual-button inspect-button small-button square"></button> <button class="to-do-remove visual-button remove-button small-button square"></button> </div>'),this.#v=this.#P('<form class="side-panel-content" action="" data-id=""> <label for="to-do-title">Title: </label> <input id="to-do-title" type="text" name="toDoTitle" maxlength="30" required> <label for="to-do-description">Description: </label> <textarea name="toDoDescription" id="to-do-description"></textarea> <label for="to-do-due-date">Due date: </label> <input type="date" id="to-do-due-date" name="toDoDueDate"> <label for="to-do-priority">Priority: </label> <select name="toDoPriority" id="to-do-priority"></select> <label for="to-do-is-checked"> Checked: <input type="checkbox" id="to-do-is-checked" name="toDoIsChecked"> </label> <div class="side-panel-buttons"> <button type="button" class="cancel-button form-button cancel">Cancel</button> <button type="submit" class="confirm-button form-button">Confirm</button> </div> </form>'),this.#g=document.querySelector(".side-panel"),this.#f()}static displayData(t){this.#D(t)}static selectFirstProject(){this.#C(),this.#u.children.length>0&&(this.#u.children[0].classList.add("project-selected"),this.#d.updateCurrentProject())}static getCurrentProjectId(){let t=null;for(const e of this.#u.children)e.classList.contains("project-selected")&&(t=e.getAttribute("data-id"));return t}static clearTodos(){this.#y.innerHTML=""}static clearSidePanel(){this.#g.innerHTML=""}static#T(t){Object.entries(s).forEach((([e,i])=>{const o=document.createElement("option");o.value=i,o.textContent=e.charAt(0)+e.slice(1).toLowerCase(),t.appendChild(o),t.value=s.MEDIUM}))}static displayToDos(t){if(this.clearTodos(),this.clearSidePanel(),null===t)return;const e=this.#b.cloneNode(!0).firstElementChild;e.querySelector(".main-panel-project-name").textContent=t.name+" to-dos",this.#y.appendChild(e);const i=document.createElement("div");i.classList.add("main-panel-content"),this.#y.appendChild(i),e.querySelector("#add-todo-button").addEventListener("click",(t=>{this.clearSidePanel();const e=this.#v.cloneNode(!0).firstElementChild;this.#T(e.querySelector("#to-do-priority"));const i=(new Date).toISOString().split("T")[0];e.querySelector("#to-do-due-date").value=i,e.querySelector(".cancel-button").addEventListener("click",(t=>{this.clearSidePanel()})),e.querySelector(".confirm-button").addEventListener("click",(t=>{if(!e.checkValidity())return;t.preventDefault();const i=this.#d.addToDo(e.querySelector("#to-do-title").value,e.querySelector("#to-do-description").value,e.querySelector("#to-do-due-date").value,e.querySelector("#to-do-priority").value,e.querySelector("#to-do-is-checked").checked.toString());this.clearSidePanel(),this.#k(i,document.querySelector(".main-panel-content"))})),this.#g.appendChild(e),e.querySelector("#to-do-title").focus()})),t.toDos.sort(((t,e)=>parseInt(t.id.split("-")[0],10)-parseInt(e.id.split("-")[0],10)));for(const e of t.toDos)this.#k(e,i)}static#k(t,e){const i=this.#j.cloneNode(!0).firstElementChild;i.setAttribute("data-id",t.id),i.classList.add("priority-"+t.priority),i.querySelector(".preview-title").textContent=t.title,i.querySelector(".preview-due-date").textContent=t.dueDate;const o=i.querySelector(".preview-checkbox");"true"===t.isChecked?o.checked=!0:o.checked=!1,e.insertBefore(i,e.firstChild),i.querySelector(".preview-checkbox").addEventListener("change",(t=>{this.#d.checkEdit(i.getAttribute("data-id"),o.checked)})),i.querySelector(".inspect-button").addEventListener("click",(e=>{this.clearSidePanel();const o=this.#v.cloneNode(!0).firstElementChild;this.#T(o.querySelector("#to-do-priority")),o.setAttribute("data-id",t.id),o.querySelector("#to-do-title").value=t.title,o.querySelector("#to-do-description").value=t.description,o.querySelector("#to-do-due-date").value=t.dueDate,o.querySelector("#to-do-priority").value=t.priority,o.querySelector("#to-do-is-checked").checked="true"===t.isChecked,o.querySelector(".cancel-button").addEventListener("click",(t=>{this.clearSidePanel()})),o.querySelector(".confirm-button").addEventListener("click",(e=>{o.checkValidity()&&(e.preventDefault(),this.#d.editToDo(t.id,o.querySelector("#to-do-title").value,o.querySelector("#to-do-description").value,o.querySelector("#to-do-due-date").value,o.querySelector("#to-do-priority").value,o.querySelector("#to-do-is-checked").checked.toString()),this.clearSidePanel(),this.#q(t,i))})),this.#g.appendChild(o)})),i.querySelector(".remove-button").addEventListener("click",(e=>{i.parentElement.removeChild(i),this.#d.removeToDo(i.getAttribute("data-id"));const o=this.#I();null!==o&&o.getAttribute("data-id")===t.id&&this.clearSidePanel()}))}static#I(){return document.querySelector(".side-panel-content")}static#q(t,e){e.querySelector(".preview-title").textContent=t.title,e.querySelector(".preview-due-date").textContent=t.dueDate,e.querySelector(".preview-checkbox").checked="true"===t.isChecked,e.classList.remove("priority-low"),e.classList.remove("priority-medium"),e.classList.remove("priority-high"),e.classList.add("priority-"+t.priority)}static#E(t){t?(this.#h.style.display="grid",this.#m.style.visibility="hidden",this.#S.focus()):(this.#h.reset(),this.#h.style.display="none",this.#m.style.visibility="visible")}static#f(){const t=this.#h.querySelector('button[type="button"]'),e=this.#h.querySelector('button[type="submit"]');this.#m.addEventListener("click",(t=>{this.#E(!0)})),t.addEventListener("click",(t=>{this.#E(!1)})),e.addEventListener("click",(t=>{if(!this.#h.checkValidity())return;t.preventDefault();const e=this.#h.querySelector('input[name="projectName"]'),i=this.#d.addProject(e.value);this.#E(!1),this.#A(i)}))}static#P(t){const e=document.createElement("template");return e.innerHTML=t.trim(),e.content}static#C(){for(const t of this.#u.children)t.classList.remove("project-selected")}static#A(t){const e=this.#p.cloneNode(!0).firstElementChild;e.querySelector(".project-name").textContent=t.name,e.setAttribute("data-id",t.id),this.#u.insertBefore(e,this.#u.firstChild),e.querySelector("button.project-remove").addEventListener("click",(t=>{t.stopPropagation(),e.parentElement.removeChild(e),this.#d.removeProject(e.getAttribute("data-id"))})),e.addEventListener("click",(i=>{this.#C(),e.classList.add("project-selected"),this.#d.updateCurrentProject(),this.displayToDos(t)}))}static#D(t){t.sort(((t,e)=>parseInt(t.id.split("-")[0],10)-parseInt(e.id.split("-")[0],10)));for(const e of t)this.#A(e)}}class c{static#L="id";static#F="class";static#w="classRef";static#R={ToDo:{classRef:i,paramOrder:["title","description","dueDate","priority","isChecked","projectId"]},Project:{classRef:o,paramOrder:["name"]}};static serialize(t){const e=this.#_(t);return e[this.#F]=t.constructor.name,JSON.stringify(e)}static deserialize(t,e){const i=JSON.parse(t),o=this.#x(i);return o.id=e,o}static#_(t){const e=Object.getPrototypeOf(t),i=Object.getOwnPropertyDescriptors(e),o={};for(const[e,r]of Object.entries(i))if(e!==this.#L&&"function"==typeof r.get){const i=t[e];Array.isArray(i)||(o[e]=i)}return o}static#x(t){const e=t[this.#F],i=this.#R[e];if(!i)throw new Error(`Unregistered class: ${e}`);const o=i.paramOrder.map((e=>t[e]));return new i[this.#w](...o)}}class n{static#O=!1;static#N=null;static{this.#z()}static#z(){try{const t="__storage_test__";localStorage.setItem(t,t),localStorage.removeItem(t),this.#O=!0,this.#N=localStorage}catch(t){this.#O=!1}}static setItem(t){if(!this.#O)return;const e=c.serialize(t);this.#N.setItem(t.id,e)}static getItem(t){if(!this.#O)return;const e=this.#N.getItem(t);return c.deserialize(e,t)}static getItems(){if(!this.#O)return;const t=[],e=[];for(let r=0;r<this.#N.length;r++){const s=this.#N.key(r),a=this.getItem(s);a instanceof o?t.push(a):a instanceof i&&e.push(a)}return e.forEach((e=>{const i=t.find((t=>t.id===e.projectId));i&&i.pushToDo(e)})),t}static clear(){this.#O&&this.#N.clear()}static removeItem(t){this.#O&&this.#N.removeItem(t)}}class l{static#H="Default Project";static#V=null;static{this.#z()}static#z(){this.#B(),a.initialize(this),a.displayData(r.getProjects()),a.selectFirstProject(),a.displayToDos(this.#V)}static#B(){r.setProjects(n.getItems()),this.#M()}static#M(){if(0===r.getProjects().length){const t=r.addProject(this.#H+" 01");n.setItem(t);const e=t.addToDo("Some task","Super description","2025-05-10",s.LOW,"false");n.setItem(e)}}static addProject(t){const e=r.addProject(t);return n.setItem(e),e}static removeProject(t){const e=r.getRelatedToDos(t);for(const t of e)n.removeItem(t.id);r.removeProject(t),n.removeItem(t),null===a.getCurrentProjectId()&&(a.selectFirstProject(),a.displayToDos(this.#V))}static removeToDo(t){r.getProject(this.#V.id).removeToDo(t),n.removeItem(t)}static updateCurrentProject(){this.#V=null;const t=a.getCurrentProjectId();null!==t&&(this.#V=r.getProject(t))}static checkEdit(t,e){const i=r.getProject(this.#V.id).getToDo(t);i.isChecked=e.toString(),n.setItem(i)}static addToDo(t,e,i,o,r){const s=this.#V.addToDo(t,e,i,o,r);return n.setItem(s),s}static editToDo(t,e,i,o,r,s){const a=this.#V.getToDo(t);return a.edit(e,i,o,r,s),n.setItem(a),a}}})();